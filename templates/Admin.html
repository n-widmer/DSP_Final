{% extends 'index.html' %}

{% block body %}
<link rel="stylesheet" href="{{ url_for('static', filename='admin_table.css') }}">

<section class="content admin-panel">
    <header class="admin-header">
        <h1>
            Admin Panel
            <span>Logged in as {{ username }} Â· Group {{ group }}</span>
        </h1>

        {% if show_names %}
            <p class="admin-subtitle">
                You have full access to patient records, including identifiable information.
            </p>
        {% else %}
            <p class="admin-subtitle warning">
                You have restricted access. Patient names are hidden for privacy.
            </p>
        {% endif %}
    </header>

     {% if group == 'H' %}
     <div class="admin-action">
        <a href="{{ url_for('add_patient_route') }}" class="admin-btn">Add Patient</a> <!-- url and function name were mismatched i fixed -->
     </div>
     {% endif %}

    <div class="table-wrapper">
        <table class="patients-table">
            <thead>
                <tr>
                    {% if show_names %}
                        <th>First Name</th>
                        <th>Last Name</th>
                    {% endif %}
                    <th>Gender</th>
                    <th>Age</th>
                    <th>Weight</th>
                    <th>Height</th>
                    <th>Health History</th>
                </tr>
            </thead>
            <tbody>
                {% if patients %}
                    {% for p in patients %}
                        <tr>
                            {% if show_names %}
                                <td>{{ p.first_name }}</td>
                                <td>{{ p.last_name }}</td>
                            {% endif %}
                            <td>{{ p.Gender }}</td>
                            <td>{{ p.Age }}</td>
                            <td>{{ p.Weight }}</td>
                            <td>{{ p.Height }}</td>
                            <td class="cell-history">{{ p.health_history }}</td>
                        </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td class="empty-row" colspan="{{ 5 if not show_names else 7 }}">
                            No patient records found.
                        </td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</section>
{% endblock %}
